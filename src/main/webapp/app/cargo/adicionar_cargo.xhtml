<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <f:metadata>
        <f:viewParam name="id" value="#{cargoController.selectedCargoId}" />
        <f:viewAction action="#{cargoController.loadCargoForEdit}" 
                     rendered="#{not empty param.id}" />
    </f:metadata>

    <h:head>
        <title>
            <h:outputText value="Editar Cargo" rendered="#{cargoController.editMode}" />
            <h:outputText value="Novo Cargo" rendered="#{!cargoController.editMode}" />
        </title>
        <h:outputStylesheet library="css" name="admin.css"/>
        <h:outputStylesheet library="css" name="servicos.css"/>
        <h:outputStylesheet library="css" name="cargos.css"/>
    </h:head>
    
    <h:body>

        <div class="servicos-container">
            <!-- Header -->
            <div class="servicos-header">
                <h1>#{cargoController.formTitle}</h1>
                <div class="servicos-actions">
                    <h:form>
                        <h:commandButton value="Voltar à Lista" 
                                       action="#{cargoController.navigateToList}"
                                       styleClass="btn btn-secondary"
                                       immediate="true" />
                    </h:form>
                </div>
            </div>

            <!-- Formulário -->
            <h:form>
                <!-- Campos hidden para mensagens -->
                <h:inputHidden id="hiddenLastMessage" value="#{cargoController.lastMessage}" />
                <h:inputHidden id="hiddenMessageType" value="#{cargoController.messageType}" />
                
                <!-- Mensagem flutuante personalizada -->
                <div id="floating-message" class="floating-message" style="display: none;"></div>
                           
                <div class="servicos-form">
                    <div class="form-group">
                        <h:outputLabel for="nome" value="Nome do Cargo:" styleClass="form-label required" />
                        <h:inputText id="nome" 
                                   value="#{cargoController.cargo.nome}" 
                                   styleClass="form-control"
                                   placeholder="Digite o nome do cargo"
                                   maxlength="100" />
                        <h:message for="nome" styleClass="field-error" />
                    </div>
                    
                    <div class="form-actions">
                        <h:commandButton value="#{cargoController.saveButtonText}" 
                                       action="#{cargoController.saveAndReturn}"
                                       styleClass="btn btn-primary"
                                       oncomplete="verificarMensagemAposSalvar();">
                            <f:ajax execute="@form" render="@form" />
                        </h:commandButton>
                        
                        <h:commandButton value="Cancelar" 
                                       action="#{cargoController.navigateToList}"
                                       styleClass="btn btn-secondary"
                                       immediate="true" />
                        
                        <h:commandButton value="Salvar e Continuar" 
                                       action="#{cargoController.save}"
                                       styleClass="btn btn-outline-primary"
                                       rendered="#{!cargoController.editMode}"
                                       onclick="setTimeout(() => { if(window.monitorarMensagemSucesso) monitorarMensagemSucesso(); }, 100);">
                            <f:ajax execute="@form" render="@form" />
                        </h:commandButton>
                    </div>
                </div>
            </h:form>
        </div>
        
        <!-- Scripts modularizados para cargo -->
        <h:outputScript name="js/floating-messages.js" />
        <h:outputScript name="js/form-success-monitor.js" />
        <h:outputScript name="js/cargo/cargo-validation.js" />
        <h:outputScript name="js/cargo/cargo-main.js" />
    </h:body>
</html>