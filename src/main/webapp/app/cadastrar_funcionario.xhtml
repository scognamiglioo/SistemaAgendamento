<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Gerenciar Funcionário</title>
    <h:outputStylesheet library="css" name="cadastro_func.css" />
</h:head>

<h:body>
    <h:form id="formFuncionario">
        <h:panelGroup layout="block" styleClass="container">
            <h1>Cadastrar Novo Funcionário</h1>

            <!-- Mensagens de Erro -->
            <h:messages id="messages" globalOnly="false" layout="table" styleClass="error-messages"
                        errorClass="error-message" infoClass="info-message" />

            <fieldset>
                <legend>Dados Pessoais</legend>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="nome" value="Nome:" styleClass="required" />
                    <h:inputText id="nome" value="#{employeeController.employee.nome}" required="true" 
                                 requiredMessage="Nome é obrigatório"
                                 validatorMessage="Nome deve ter entre 3 e 100 caracteres">
                        <f:validateLength minimum="3" maximum="100" />
                    </h:inputText>
                </h:panelGroup>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="cpf" value="CPF:" styleClass="required" />
                    <h:inputText id="cpf" value="#{employeeController.employee.cpf}" required="true"
                                 requiredMessage="CPF é obrigatório"
                                 validatorMessage="CPF deve conter 11 dígitos">
                        <f:validateRegex pattern="\d{11}" />
                    </h:inputText>
                </h:panelGroup>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="email" value="Email:" styleClass="required" />
                    <h:inputText id="email" value="#{employeeController.employee.email}" required="true"
                                 requiredMessage="Email é obrigatório" type="email"
                                 validatorMessage="Email inválido" />
                </h:panelGroup>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="telefone" value="Telefone:" />
                    <h:inputText id="telefone" value="#{employeeController.employee.telefone}"
                                 validatorMessage="Telefone deve conter 10 ou 11 dígitos">
                        <f:validateRegex pattern="(\d{10}|\d{11})?" />
                    </h:inputText>
                </h:panelGroup>
            </fieldset>

            <!-- Dados de Acesso -->
            <fieldset>
                <legend>Dados de Acesso</legend>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="username" value="Username:" styleClass="required" />
                    <h:inputText id="username" value="#{employeeController.employee.username}" required="true"
                                 requiredMessage="Username é obrigatório"
                                 validatorMessage="Username deve ter entre 4 e 50 caracteres">
                        <f:validateLength minimum="4" maximum="50" />
                    </h:inputText>
                </h:panelGroup>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="password" value="Senha:" styleClass="required" />
                    <h:inputSecret id="password" value="#{employeeController.employee.password}" required="true"
                                   requiredMessage="Senha é obrigatória"
                                   validatorMessage="Senha deve ter entre 6 e 50 caracteres">
                        <f:validateLength minimum="6" maximum="50" />
                    </h:inputSecret>
                </h:panelGroup>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="role" value="Perfil:" styleClass="required" />
                    <h:selectOneMenu id="role" value="#{employeeController.selectedRole}" required="true"
                                    requiredMessage="Perfil é obrigatório">
                        <f:selectItems value="#{employeeController.roles}" var="role" 
                                       itemLabel="#{role}" itemValue="#{role}" />
                    </h:selectOneMenu>
                </h:panelGroup>
            </fieldset>

            <!-- Dados Profissionais -->
            <fieldset>
                <legend>Dados Profissionais</legend>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="cargo" value="Cargo:" styleClass="required" />
                    <h:selectOneMenu id="cargo" value="#{employeeController.selectedCargoId}" required="true"
                                    requiredMessage="Cargo é obrigatório">
                        <f:selectItem itemLabel="-- Selecione um Cargo --" itemValue="" />
                        <f:selectItems value="#{employeeController.cargos}" var="cargo"
                                       itemLabel="#{cargo.nome}" itemValue="#{cargo.id}" />
                    </h:selectOneMenu>
                </h:panelGroup>

                <h:panelGroup layout="block" styleClass="form-group-checkbox">
                    <h:selectBooleanCheckbox id="ativo" value="#{employeeController.employee.ativo}" />
                    <h:outputLabel for="ativo" value="Ativo" />
                </h:panelGroup>
            </fieldset>

            <!-- Serviços -->
            <fieldset>
                <legend>Serviços</legend>

                <h:panelGroup layout="block" styleClass="form-group">
                    <h:outputLabel for="servicos" value="Serviços Atribuídos:" />
                    <h:selectManyCheckbox id="servicos" value="#{employeeController.selectedServicosIds}"
                                          layout="pageDirection">
                        <f:selectItems value="#{employeeController.servicos}" var="servico"
                                       itemLabel="#{servico.nome}" itemValue="#{servico.id}" />
                    </h:selectManyCheckbox>
                    <span class="info-text">Opcional: marque os serviços que o funcionário pode prestar</span>
                </h:panelGroup>
            </fieldset>

            <!-- Botões -->
            <h:panelGroup layout="block" styleClass="button-group">
                <h:commandButton action="#{employeeController.save()}" value="Salvar" 
                                styleClass="btn btn-primary" />
                <h:button value="Cancelar" outcome="/app/admin.xhtml" styleClass="btn btn-secondary" />
            </h:panelGroup>
        </h:panelGroup>
    </h:form>
</h:body>

</html>
